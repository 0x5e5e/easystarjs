var EasyStar=EasyStar||{};EasyStar.Node=function(a,b,c,d,e){this.parent=a,this.x=b,this.y=c,this.costSoFar=d,this.simpleDistanceToTarget=e,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}},EasyStar.Node.OPEN_LIST=0,EasyStar.Node.CLOSED_LIST=1,EasyStar.PriorityQueue=function(a,b){this.length=0;var c=[],d=!1;if(b==EasyStar.PriorityQueue.MAX_HEAP)d=!0;else{if(b!=EasyStar.PriorityQueue.MIN_HEAP)throw b+" not supported.";d=!1}this.insert=function(b){if(!b.hasOwnProperty(a))throw"Cannot insert "+b+" because it does not have a property by the name of "+a+".";c.push(b),this.length++,e(this.length-1)},this.getHighestPriorityElement=function(){return c[0]},this.shiftHighestPriorityElement=function(){if(0===this.length)throw"There are no more elements in your priority queue.";if(1===this.length){var a=c[0];return c=[],this.length=0,a}var b=c[0],d=c.pop();return this.length--,c[0]=d,f(0),b};var e=function(a){if(0!==a){var b=i(a);h(a,b)&&(g(a,b),e(b))}},f=function(a){if(left=j(a),right=k(a),h(left,a))g(a,left),f(left);else if(h(right,a))g(a,right),f(right);else{if(0==a)return;f(0)}},g=function(a,b){var d=c[a];c[a]=c[b],c[b]=d},h=function(b,e){return void 0===c[e]||void 0===c[b]?!1:("function"==typeof c[b][a]?(selfValue=c[b][a](),targetValue=c[e][a]()):(selfValue=c[b][a],targetValue=c[e][a]),d?selfValue>targetValue?!0:!1:targetValue>selfValue?!0:!1)},i=function(a){return Math.floor(a/2)-1},j=function(a){return 2*a+1},k=function(a){return 2*a+2}},EasyStar.PriorityQueue.MAX_HEAP=0,EasyStar.PriorityQueue.MIN_HEAP=1,EasyStar.instance=function(){this.isDoneCalculating=!0,this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList},EasyStar.js=function(){var a,b,c,d=10,e=14,f={},g=[],h=Number.MAX_VALUE,i=!1;this.setAcceptableTiles=function(a){c=a},this.enableDiagonals=function(){i=!0},this.disableDiagonals=function(){i=!1},this.setGrid=function(b){a=b},this.setIterationsPerCalculation=function(a){h=a},this.avoidAdditionalPoint=function(a,b){f[a+"_"+b]=1},this.stopAvoidingAdditionalPoint=function(a,b){delete f[a+"_"+b]},this.stopAvoidingAllAdditionalPoints=function(){f={}},this.findPath=function(b,e,f,h,i){if(void 0===c)throw"You can't set a path without first calling setAcceptableTiles() on EasyStar.";if(void 0===a)throw"You can't set a path without first calling setGrid() on EasyStar.";if(0>b||0>e||0>f||0>f||b>a[0].length-1||e>a.length-1||f>a[0].length-1||h>a.length-1)throw"Your start or end point is outside the scope of your grid.";b===f&&e===h&&i([]);for(var j=a[h][f],l=!1,m=0;m<c.length;m++)if(j===c[m]){l=!0;break}if(l===!1)return i(null),void 0;var n=new EasyStar.instance;n.openList=new EasyStar.PriorityQueue("bestGuessDistance",EasyStar.PriorityQueue.MIN_HEAP),n.isDoneCalculating=!1,n.nodeHash={},n.startX=b,n.startY=e,n.endX=f,n.endY=h,n.callback=i,n.openList.insert(k(n,n.startX,n.startY,null,d)),g.push(n)},this.calculate=function(){if(0!==g.length&&void 0!==a&&void 0!==c)for(b=0;h>b;b++){if(0===g.length)return;if(0!==g[0].openList.length){var f=g[0].openList.shiftHighestPriorityElement();if(f.list=EasyStar.Node.CLOSED_LIST,f.y>0&&(j(g[0],f,0,-1,d),g[0].isDoneCalculating===!0))g.shift();else if(f.x<a[0].length-1&&(j(g[0],f,1,0,d),g[0].isDoneCalculating===!0))g.shift();else if(f.y<a.length-1&&(j(g[0],f,0,1,d),g[0].isDoneCalculating===!0))g.shift();else if(f.x>0&&(j(g[0],f,-1,0,d),g[0].isDoneCalculating===!0))g.shift();else if(i){if(f.x>0&&f.y>0&&(j(g[0],f,-1,-1,e),g[0].isDoneCalculating===!0)){g.shift();continue}if(f.x<a[0].length-1&&f.y<a.length-1&&(j(g[0],f,1,1,d),g[0].isDoneCalculating===!0)){g.shift();continue}if(f.x<a[0].length-1&&f.y>0&&(j(g[0],f,1,-1,d),g[0].isDoneCalculating===!0)){g.shift();continue}if(f.x>0&&f.y<a.length-1&&(j(g[0],f,-1,1,d),g[0].isDoneCalculating===!0)){g.shift();continue}}}else g[0].callback(null),g.shift()}};var j=function(b,d,e,g,h){var i=d.x+e,j=d.y+g;if(b.endX===i&&b.endY===j){b.isDoneCalculating=!0;var l=[],m=0;l[m]={x:i,y:j},m++,l[m]={x:d.x,y:d.y},m++;for(var n=d.parent;null!=n;)l[m]={x:n.x,y:n.y},m++,n=n.parent;l.reverse(),b.callback(l)}if(void 0===f[i+"_"+j])for(var o=0;o<c.length;o++)if(a[j][i]===c[o]){var p=k(b,i,j,d,h);void 0===p.list?(p.list=EasyStar.Node.OPEN_LIST,b.openList.insert(p)):p.list===EasyStar.Node.OPEN_LIST&&d.costSoFar+h<p.costSoFar&&(p.costSoFar=d.costSoFar+h,p.parent=d);break}},k=function(a,b,c,d,e){if(void 0!==a.nodeHash[b+"_"+c])return a.nodeHash[b+"_"+c];var f=l(b,c,a.endX,a.endY);if(null!==d)var g=d.costSoFar+e;else g=f;var h=new EasyStar.Node(d,b,c,g,f);return a.nodeHash[b+"_"+c]=h,h},l=function(a,b,c,d){return Math.floor(Math.abs(b-a)+Math.abs(d-c))}};